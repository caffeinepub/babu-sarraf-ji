{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-15T11:44:16.006Z",
  "summary": "Diff adds backend user profile fields (displayName/email/photoUrl) with a migration, frontend deterministic name fallback utilities, a post-login profile prefetch bootstrapper, and UI updates to show avatar/name/timestamps in Community components and Test History. However, Community non-admin users likely cannot fetch other users’ profiles due to backend authorization on getUserProfile, preventing consistent name/photo display across authors.",
  "missing_requirements": [
    {
      "id": "REQ-98",
      "requirement": "Ensure Community (posts, comments, chat) shows the same resolved author name (and photo if available) for a given principal.",
      "reason": "Frontend attempts to load other users’ profiles via actor.getUserProfile(principal), but backend getUserProfile traps unless caller==user or caller is admin. This prevents regular users from accessing other authors’ profile data, so Community cannot consistently display authenticated names/photos for other principals (will fall back to short principal).",
      "evidence": [
        "backend/main.mo (getUserProfile authorization check)",
        "frontend/src/hooks/community/useUserProfiles.ts (calls actor.getUserProfile for arbitrary principalString)"
      ]
    }
  ],
  "hallucinated_features": [],
  "confidence": 0.72,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/components/AppLayout.tsx",
    "frontend/src/components/community/ChatPanel.tsx",
    "frontend/src/components/community/CommentsSection.tsx",
    "frontend/src/components/community/PostCard.tsx",
    "frontend/src/components/testSeries/TestHistory.tsx",
    "frontend/src/components/user/AuthProfileBootstrapper.tsx",
    "frontend/src/components/user/UserAvatar.tsx",
    "frontend/src/hooks/community/useUserProfiles.ts",
    "frontend/src/lib/userIdentity.ts",
    "project_state.json"
  ]
}